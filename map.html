<!DOCTYPE html><html lang="en"><head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous"> <title>Location Sharing</title> <link rel="stylesheet" href="map.css"> <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/easy-autocomplete/1.3.5/easy-autocomplete.min.css"> <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/easy-autocomplete/1.3.5/jquery.easy-autocomplete.min.js"></script></head><body> <div class="hideme"> <label for="location">Location:</label> <input type="text" id="location" placeholder="Enter a location"/> <button onclick="geocodeLocation()">Find Location</button> </div><div> <button type="button" class="btn btn-success" onclick="getUserLocation()" style="background-color:tomato; border: 1px solid tomato;">Click to get your location</button> </div><br><div id="map" style="height: 400px;"></div><br><div class="thosetext"> <p id="distanceInfo">Estimated Distance from store: </p><p id="costInfo">Estimated Delivery Cost: </p></div><button onclick="sendLocationToWhatsApp()" class="whatsappbutton"> <span class="image-icon" style="margin-right:3px;"></span><span>Submit Location on WhatsApp</span> </button> <script>var map=L.map("map").setView([5.6705525, -0.1767918], 15); var marker=L.marker([0, 0],{draggable: true}).addTo(map); var newLatitude=0; var newLongitude=0; L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map); var options={url: function(phrase){return "https://nominatim.openstreetmap.org/search?format=json&q=" + phrase;}, getValue: "display_name", list:{match:{enabled: true}}}; $("#location").easyAutocomplete(options); marker.on("dragend", function(event){var newLatLng=event.target.getLatLng(); newLatitude=newLatLng.lat; newLongitude=newLatLng.lng; document.getElementById("location").value=newLatitude + ", " + newLongitude; var initialCoordinates=[5.6705525, -0.1767918]; var distance=calculateDistance(initialCoordinates, [newLatitude, newLongitude]); var cost=calculateCost(distance); document.getElementById("distanceInfo").innerText="Estimated distance from store: " + distance.toFixed(2) + " miles"; document.getElementById("costInfo").innerText="Estimated Delivery Cost: " + cost;}); function geocodeLocation(){var locationInput=document.getElementById("location").value; var geocodeURL="https://nominatim.openstreetmap.org/search?format=json&q=" + locationInput; fetch(geocodeURL) .then(response=> response.json()) .then(data=>{if (data.length > 0){newLatitude=parseFloat(data[0].lat); newLongitude=parseFloat(data[0].lon); map.setView([newLatitude, newLongitude], 15); marker.setLatLng([newLatitude, newLongitude]); marker.bindPopup("Updated Marker Title").openPopup(); var initialCoordinates=[5.6705525, -0.1767918]; var distance=calculateDistance(initialCoordinates, [newLatitude, newLongitude]); var cost=calculateCost(distance); document.getElementById("distanceInfo").innerText="Estimated Distance from store: " + distance.toFixed(2) + " miles"; document.getElementById("costInfo").innerText="Estimated Delivery Cost: " + cost;}else{alert("Location not found.");}}) .catch(error=>{console.error(error); alert("Error geocoding location.");});}function getUserLocation(){if ("geolocation" in navigator){navigator.geolocation.getCurrentPosition(function (position){newLatitude=position.coords.latitude; newLongitude=position.coords.longitude; map.setView([newLatitude, newLongitude], 15); marker.setLatLng([newLatitude, newLongitude]); marker.bindPopup("My Location").openPopup(); var initialCoordinates=[5.6705525, -0.1767918]; var distance=calculateDistance(initialCoordinates, [newLatitude, newLongitude]); var cost=calculateCost(distance); document.getElementById("distanceInfo").innerText="Estimated Distance from store: " + distance.toFixed(2) + " miles"; document.getElementById("costInfo").innerText="Estimated Delivery Cost: " + cost;}, function (error){console.error("Error getting location: " + error.message); alert("Error getting your location. Please enable location services.");});}else{alert("Geolocation is not supported by your browser.");}}function sendLocationToWhatsApp(){var locationURL="https://www.openstreetmap.org/?mlat=" + newLatitude + "&mlon=" + newLongitude; var distance=document.getElementById("distanceInfo").innerText; var cost=document.getElementById("costInfo").innerText; var whatsappMessage="Location: " + locationURL + "\n" + distance + "\n" + cost; var phoneNumber="233546967052"; var whatsappURL="https://api.whatsapp.com/send?phone=" + phoneNumber + "&text=" + encodeURIComponent(whatsappMessage); window.open(whatsappURL);}function calculateDistance(coord1, coord2){var R=3958.8; var lat1=coord1[0]; var lon1=coord1[1]; var lat2=coord2[0]; var lon2=coord2[1]; var dLat=toRadians(lat2 - lat1); var dLon=toRadians(lon2 - lon1); var a=Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(toRadians(lat1)) * Math.cos(toRadians(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2); var c=2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)); return R * c;}function toRadians(degrees){return degrees * (Math.PI / 180);}function calculateCost(distance){if (distance < 2){return "₵" + (15).toFixed(2);}else if (distance >=2 && distance < 3){return "₵" + (20).toFixed(2);}else if (distance >=3 && distance < 4){return "₵" + (25).toFixed(2);}else if (distance >=4 && distance < 5){return "₵" + (30).toFixed(2);}else if (distance >=5 && distance < 7){return "₵" + (37).toFixed(2);}else if (distance >=7 && distance < 9){return "₵" + (40).toFixed(2);}else if (distance >=9 && distance < 11){return "₵" + (46).toFixed(2);}else if (distance >=11 && distance < 14){return "₵" + (50).toFixed(2);}else if (distance >=14 && distance < 15.5){return "₵" + (60).toFixed(2);}else if (distance >=15.5 && distance < 17){return "₵" + (65).toFixed(2);}else if (distance >=17 && distance < 19){return "₵" + (75).toFixed(2);}else if (distance >=19 && distance < 20){return "₵" + (80).toFixed(2);}else{return "Delivery will be negotiated since distance from store exceeds 20 miles";}}</script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script></body></html>
